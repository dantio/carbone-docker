<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Carbone Docker wrapper tester</title>
</head>
<body>
  <form onsubmit="formatJson()" action="/render" method="post" target="_self" enctype="multipart/form-data">

    <input type="file" name="template" id="template"><br>

    <textarea name="options" id="_options" cols="30" rows="10">{"convertTo":"pdf", "outputName": "report.pdf"}</textarea><br>
    <textarea name="data" id="_data" cols="30" rows="10">{"recipient": {"name" : "John"}}</textarea><br>

    <input type="submit" value="Generate">

  </form>
  <script>

    function _formatJson(id) {
      const _data = document.getElementById(id).value;
      let data = JSON.parse(_data);
  
      document.getElementById(id).value = JSON.stringify(data);
    }

    function formatJson(e) {
      try {
      _formatData('data');
      _formatData('options');
      } catch (e) {
        e.preventDefault();
        alert('Cannot parse data')
        console.error(`Cannot parse data : ${e}`);
      }
    }
  </script>
</body>
</html>